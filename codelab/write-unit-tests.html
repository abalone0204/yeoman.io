<!DOCTYPE html><html lang=en data-version=3cc002a><head><meta charset=utf-8><title>Step 8: Test with Karma and Jasmine | Yeoman</title><meta name=viewport content="width=device-width"><link rel=icon type=image/x-icon href=/static/favicon.b25e58c4b8.ico><link href="http://fonts.googleapis.com/css?family=Roboto+Slab:400,700|Roboto:400,700,700italic,400italic" rel=stylesheet><link rel=stylesheet href=/static/bundle-5327.4dd1f5e839.css><style>em{padding-right:2px}.highlight>pre,code.prettyprint{color:white}.social{margin-top:25px}.authors{font-style:italic}.keyboard{border:1px solid #ccc;border-radius:5px;padding:2px 6px;font-style:normal}.note{padding:25px}.note pre,.note code{padding:.2em .4em;border-radius:3px;border-width:0}.note.important{background:#f2dede}.note.important code,.note.important pre{background:#e2cbcb}.note.tip{background:#d2e0d2}.note.tip code,.note.tip pre{background:#bed3be}.note p,.note li{font-size:.9em}.note h2{font-size:1em;margin-top:1em}.note *:first-child{margin-top:0}.note *:last-child{margin-bottom:0}.mast-holder{width:100%;text-align:center}.mast-holder img{max-height:350px}.mast-intro>img{max-height:300px}@media(min-width:761px){.mast-intro>img{float:left;margin:-10px 10px 0 0;display:block}.mast-intro ~ h2{clear:left}article{overflow:auto}}@media(min-width:761px){.side-by-side{overflow:auto}.side-by-side img{width:50%;float:left}}.codelab-paging{margin-top:2em;text-align:center}.codelab-paging a{font-weight:bold;white-space:nowrap}.codelab-paging a:first-child{margin-right:1em}.codelab-paging a:nth-of-type(2){margin-left:1em}</style><link href=/blog/atom.xml type=application/atom+xml rel=alternate title="Yeoman Blog Atom Feed"></head><body class=codelab><header class=page-header><div class=container><div class=mobile-bar><h1 class=logo><a href="/"><img src=/static/logo.f0661e3819.png alt=Yeoman></a></h1><button class="mobile-menu-toggle ir">open</button></div><nav class=main-menu><ul class=main-nav><li><a href="/learning/">Using Yeoman</a><ul> <li><a href=/learning/index.html>Getting started</a></li> <li><a href=/codelab/index.html>Tutorial (codelab)</a></li> <li><a href=/learning/resources.html>Resources</a></li> <li><a href=/learning/deployment.html>Deployment</a></li> <li><a href=/learning/faq.html>FAQ</a></li> <li><a href=/learning/support.html>Support</a></li></ul></li><li><a href="/generators/">Discovering generators</a></li> <li><a href="/authoring/">Creating a generator</a><ul> <li><a href=/authoring/index.html>Getting started</a></li> <li><a href=/authoring/running-context.html>Running Context</a></li> <li><a href=/authoring/user-interactions.html>User Interactions</a></li> <li><a href=/authoring/composability.html>Composability</a></li> <li><a href=/authoring/dependencies.html>Managing Dependencies</a></li> <li><a href=/authoring/file-system.html>Interacting with the file system</a></li> <li><a href=/authoring/gruntfile.html>Creating a Gruntfile</a></li> <li><a href=/authoring/storage.html>Storing user configs</a></li> <li><a href=/authoring/testing.html>Unit testing</a></li> <li><a href=/authoring/debugging.html>Debugging Generators</a></li> <li><a href=/authoring/integrating-yeoman.html>Integrating Yeoman in other tools</a></li> <li><a href="http://yeoman.github.io/generator/">Full API documentation</a></li></ul></li><li><a href="/blog/">Blog</a></li> <li><a href="/contributing/">Contributing</a><ul> <li><a href=/contributing/index.html>Contributing</a></li> <li><a href=/contributing/opening-issues.html>How to open an issue</a></li> <li><a href=/contributing/pull-request.html>How to submit a PR</a></li> <li><a href=/contributing/style-guide.html>Style Guide</a></li> <li><a href=/contributing/testing-guidelines.html>Testing Guidelines</a></li> <li><a href=/contributing/ticketing.html>Issue system overview</a></li></ul></li></ul></nav></div></header><div id=content><h2 class=page-title><div class=container>Step 8: Test with Karma and Jasmine</div></h2><div class="container clearfix has-sidebar"><nav class=context-nav><ul><li><a href=/codelab/index.html>Let's Scaffold a Web App</a></li> <li><a href=/codelab/meet-yeoman.html>Meet Yeoman</a></li> <li><a href=/codelab/setup.html>Step 1</a></li> <li><a href=/codelab/install-generators.html>Step 2</a></li> <li><a href=/codelab/scaffold-app.html>Step 3</a></li> <li><a href=/codelab/review-generated-files.html>Step 4</a></li> <li><a href=/codelab/preview-inbrowser.html>Step 5</a></li> <li><a href=/codelab/write-app.html>Step 6</a></li> <li><a href=/codelab/install-packages.html>Step 7</a></li> <li><a href=/codelab/write-unit-tests.html class=active>Step 8</a></li> <li><a href=/codelab/prepare-production.html>Step 9</a></li> <li><a href=/codelab/local-storage.html>Step 10</a></li> <li><a href=/codelab/keep-going.html>Keep going</a></li></ul></nav><article class=main><div class=social><a href=https://twitter.com/share class=twitter-share-button data-text="Let's Scaffold A Web App With @Yeoman!" data-url="">Tweet</a><script>!function(t,e,n){var o,i=t.getElementsByTagName(e)[0],r=/^http:/.test(t.location)?"http":"https";t.getElementById(n)||(o=t.createElement(e),o.id=n,o.src=r+"://platform.twitter.com/widgets.js",i.parentNode.insertBefore(o,i))}(document,"script","twitter-wjs");</script><script src=https://apis.google.com/js/plusone.js></script><g:plus action=share></g:plus></div><section class=content-chunk><p>For those unfamiliar with <a href=http://karma-runner.github.io>Karma</a>, it is a JavaScript test runner that is test framework agnostic. The Angular generator has two included test frameworks: <a href=https://code.angularjs.org/1.2.16/docs/guide/e2e-testing>ngScenario</a> and <a href="http://jasmine.github.io/">Jasmine</a>. When we ran <code>yo angular</code> earlier in this codelab the generator scaffolded a <code>test</code> directory in the root of the <code>mytodo</code> folder, created a <code>karma.conf.js</code> file, and pulled in the Node modules for Karma. We’ll be editing a Jasmine script to describe our tests soon but let’s see how we can run tests first.</p><h2>Run unit tests</h2><p>Let’s go back to the command line and kill our Grunt server using <span class=keyboard>Ctrl</span>+<span class=keyboard>C</span>. There is already a Grunt task scaffolded out in our <code>Gruntfile.js</code> for running tests. It can be run as follows:</p><div class=highlight><pre><code class=language-sh data-lang=sh>grunt <span class=nb>test</span>
</code></pre></div><p>When you run <code>grunt test</code>, you'll see some warnings in the Yeoman console. Don’t worry, that’s to be expected right now since our tests are currently failing for two reasons. Let's fix that.</p><h2>Update Karma configuration</h2><p>First, we need to check the Karma configuration to see if it is loading the new Bower components we installed in <a href=install-packages.html#install>Step 7</a>.</p><p>Open <code>karma.conf.js</code>. Currently the <code>files</code> array should look like this:</p><div class=highlight><pre><code class=language-js data-lang=js>    <span class=nx>files</span><span class=o>:</span> <span class=p>[</span>
      <span class=c1>// bower:js</span>
      <span class=s1>'bower_components/jquery/dist/jquery.js'</span><span class=p>,</span>
      <span class=s1>'bower_components/angular/angular.js'</span><span class=p>,</span>
      <span class=s1>'bower_components/bootstrap/dist/js/bootstrap.js'</span><span class=p>,</span>
      <span class=s1>'bower_components/angular-animate/angular-animate.js'</span><span class=p>,</span>
      <span class=s1>'bower_components/angular-cookies/angular-cookies.js'</span><span class=p>,</span>
      <span class=s1>'bower_components/angular-resource/angular-resource.js'</span><span class=p>,</span>
      <span class=s1>'bower_components/angular-route/angular-route.js'</span><span class=p>,</span>
      <span class=s1>'bower_components/angular-sanitize/angular-sanitize.js'</span><span class=p>,</span>
      <span class=s1>'bower_components/angular-touch/angular-touch.js'</span><span class=p>,</span>
      <span class=s1>'bower_components/jquery-ui/jquery-ui.js'</span><span class=p>,</span>
      <span class=s1>'bower_components/angular-ui-sortable/sortable.js'</span><span class=p>,</span>
      <span class=s1>'bower_components/angular-mocks/angular-mocks.js'</span><span class=p>,</span>
      <span class=c1>// endbower</span>
      <span class=s1>'app/scripts/**/*.js'</span><span class=p>,</span>
      <span class=s1>'test/mock/**/*.js'</span><span class=p>,</span>
      <span class=s1>'test/spec/**/*.js'</span>
    <span class=p>],</span>
</code></pre></div><p>Bower has read in the newly added dependencies ('bower<em>components/jquery-ui/jquery-ui.js', 'bower</em>components/angular-ui-sortable/sortable.js') and automatically added them to the karma.conf.js file for you.</p><h2>Update unit tests</h2><p>You’ll find unit tests scaffolded out in the <code>test</code> folder, so open up <strong>test/spec/controllers/main.js</strong>. This is the unit test for your Angular MainCtrl controller that we need to modify.</p><p>Your boilerplate test still references <code>awesomeThings</code> so delete the following test:</p><div class=highlight><pre><code class=language-js data-lang=js><span class=nx>it</span><span class=p>(</span><span class=s1>'should attach a list of awesomeThings to the scope'</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
  <span class=nx>expect</span><span class=p>(</span><span class=nx>scope</span><span class=p>.</span><span class=nx>awesomeThings</span><span class=p>.</span><span class=nx>length</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=mi>3</span><span class=p>);</span>
<span class=p>});</span>
</code></pre></div><p>And replace that test with the following:</p><div class=highlight><pre><code class=language-js data-lang=js><span class=nx>it</span><span class=p>(</span><span class=s1>'should have no items to start'</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
  <span class=nx>expect</span><span class=p>(</span><span class=nx>scope</span><span class=p>.</span><span class=nx>todos</span><span class=p>.</span><span class=nx>length</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
<span class=p>});</span>
</code></pre></div><p>Open <code>scripts/controllers/main.js</code>.</p><p>Remove the 3 items we added earlier from the <code>$scope.todos</code> declaration:</p><div class=highlight><pre><code class=language-js data-lang=js><span class=nx>$scope</span><span class=p>.</span><span class=nx>todos</span> <span class=o>=</span> <span class=p>[];</span>
</code></pre></div><p>Re-running our tests with <code>grunt test</code> should see our tests now passing:</p><p><img src=/static/image_33.a33a479ec0.png alt=""></p><h2>Add more unit tests</h2><p>The above test only covers part of our app's functionality so let’s add a couple of more tests to test the adding and removing of items:</p><div class=highlight><pre><code class=language-js data-lang=js><span class=nx>it</span><span class=p>(</span><span class=s1>'should add items to the list'</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
  <span class=nx>scope</span><span class=p>.</span><span class=nx>todo</span> <span class=o>=</span> <span class=s1>'Test 1'</span><span class=p>;</span>
  <span class=nx>scope</span><span class=p>.</span><span class=nx>addTodo</span><span class=p>();</span>
  <span class=nx>expect</span><span class=p>(</span><span class=nx>scope</span><span class=p>.</span><span class=nx>todos</span><span class=p>.</span><span class=nx>length</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
<span class=p>});</span>

<span class=nx>it</span><span class=p>(</span><span class=s1>'should add then remove an item from the list'</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
  <span class=nx>scope</span><span class=p>.</span><span class=nx>todo</span> <span class=o>=</span> <span class=s1>'Test 1'</span><span class=p>;</span>
  <span class=nx>scope</span><span class=p>.</span><span class=nx>addTodo</span><span class=p>();</span>
  <span class=nx>scope</span><span class=p>.</span><span class=nx>removeTodo</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
  <span class=nx>expect</span><span class=p>(</span><span class=nx>scope</span><span class=p>.</span><span class=nx>todos</span><span class=p>.</span><span class=nx>length</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
<span class=p>});</span>
</code></pre></div><p>Your full MainCtrl test script (<em>test/spec/controllers/main.js</em>) should now look like this:</p><div class=highlight><pre><code class=language-js data-lang=js><span class=s1>'use strict'</span><span class=p>;</span>

<span class=nx>describe</span><span class=p>(</span><span class=s1>'Controller: MainCtrl'</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>

  <span class=c1>// load the controller's module</span>
  <span class=nx>beforeEach</span><span class=p>(</span><span class=nx>module</span><span class=p>(</span><span class=s1>'mytodoApp'</span><span class=p>));</span>

  <span class=kd>var</span> <span class=nx>MainCtrl</span><span class=p>,</span>
    <span class=nx>scope</span><span class=p>;</span>

  <span class=c1>// Initialize the controller and a mock scope</span>
  <span class=nx>beforeEach</span><span class=p>(</span><span class=nx>inject</span><span class=p>(</span><span class=kd>function</span> <span class=p>(</span><span class=nx>$controller</span><span class=p>,</span> <span class=nx>$rootScope</span><span class=p>)</span> <span class=p>{</span>
    <span class=nx>scope</span> <span class=o>=</span> <span class=nx>$rootScope</span><span class=p>.</span><span class=nx>$new</span><span class=p>();</span>
    <span class=nx>MainCtrl</span> <span class=o>=</span> <span class=nx>$controller</span><span class=p>(</span><span class=s1>'MainCtrl'</span><span class=p>,</span> <span class=p>{</span>
      <span class=nx>$scope</span><span class=o>:</span> <span class=nx>scope</span>
    <span class=p>});</span>
  <span class=p>}));</span>

  <span class=nx>it</span><span class=p>(</span><span class=s1>'should have no items to start'</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
    <span class=nx>expect</span><span class=p>(</span><span class=nx>scope</span><span class=p>.</span><span class=nx>todos</span><span class=p>.</span><span class=nx>length</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
  <span class=p>});</span>

  <span class=nx>it</span><span class=p>(</span><span class=s1>'should add items to the list'</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
    <span class=nx>scope</span><span class=p>.</span><span class=nx>todo</span> <span class=o>=</span> <span class=s1>'Test 1'</span><span class=p>;</span>
    <span class=nx>scope</span><span class=p>.</span><span class=nx>addTodo</span><span class=p>();</span>
    <span class=nx>expect</span><span class=p>(</span><span class=nx>scope</span><span class=p>.</span><span class=nx>todos</span><span class=p>.</span><span class=nx>length</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
  <span class=p>});</span>

  <span class=nx>it</span><span class=p>(</span><span class=s1>'should add then remove an item from the list'</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
    <span class=nx>scope</span><span class=p>.</span><span class=nx>todo</span> <span class=o>=</span> <span class=s1>'Test 1'</span><span class=p>;</span>
    <span class=nx>scope</span><span class=p>.</span><span class=nx>addTodo</span><span class=p>();</span>
    <span class=nx>scope</span><span class=p>.</span><span class=nx>removeTodo</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
    <span class=nx>expect</span><span class=p>(</span><span class=nx>scope</span><span class=p>.</span><span class=nx>todos</span><span class=p>.</span><span class=nx>length</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
  <span class=p>});</span>

<span class=p>});</span>
</code></pre></div><p>Running the tests again, we should see everything pass with 4 tests being executed:</p><p><img src=/static/image_34.07198050ae.png alt=""></p><p>Fantastic!</p><p>Writing unit tests make it easier to catch bugs as your app gets bigger and when more developers join your team. The scaffolding feature of Yeoman makes writing unit tests easier so no excuse for not writing your own tests! ;)</p><p class=codelab-paging><a href=#toc>« Return to overview</a> or <a href=prepare-production.html>Go to the next step »</a></p></section></article></div></div><footer class=page-footer><ul class="footer-links footer-links-social"><li><a href=https://plus.google.com/101063139999404044459/posts class=icon><img src=/static/social-gplus.cdac08228d.svg alt=Google+></a></li> <li><a href=https://twitter.com/yeoman class=icon><img src=/static/social-twitter.60eb981a15.svg alt=Twitter></a></li> <li><a href=https://github.com/yeoman/yeoman class=icon><img src=/static/social-github.767995ad17.svg alt=Github></a></li> <li><a href=/blog/atom.xml class=icon><img src=/static/social-feed.c635057faf.svg alt=Feed></a></li></ul><ul class="footer-links footer-links-contribute"><li><a href="http://yeoman.github.io/generator/" class=btn>API</a></li> <li><a href=https://github.com/yeoman/yeoman.io/blob/master/app/codelab/write-unit-tests.md class="btn btn-improve" title="Edit this page on Github to help improve the site">Improve this page</a></li></ul></footer><script src=//ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js></script><script src=/static/bundle-5392.c0574f99ba.js async></script><script>!function(n,t,e){"undefined"!=typeof e.module&&e.module.exports?e.module.exports=t():"undefined"!=typeof e.define&&"function"==e.define&&e.define.amd?define(n,t):e[n]=t()}("$script",function(){function n(n,t){for(var e=0,o=n.length;o>e;++e)if(!t(n[e]))return l;return 1}function t(t,e){n(t,function(n){return!e(n)})}function e(r,c,l){function p(n){return n.call?n():u[n]}function g(){if(!--j){u[y]=1,v&&v();for(var e in s)n(e.split("|"),p)&&!t(s[e],p)&&(s[e]=[])}}r=r[m]?r:[r];var h=c&&c.call,v=h?c:l,y=h?r.join(""):c,j=r.length;return setTimeout(function(){t(r,function(n){return d[n]?(y&&(f[y]=1),2==d[n]&&g()):(d[n]=1,y&&(f[y]=1),o(!a.test(n)&&i?i+n+".js":n,g),void 0)})},0),e}function o(n,t){var e=r.createElement("script"),o=l;e.onload=e.onerror=e[v]=function(){e[g]&&!/^c|loade/.test(e[g])||o||(e.onload=e[v]=null,o=1,d[n]=2,t())},e.async=1,e.src=n,c.insertBefore(e,c.firstChild)}var i,r=document,c=r.getElementsByTagName("head")[0],a=/^https?:\/\//,u={},f={},s={},d={},l=!1,m="push",p="DOMContentLoaded",g="readyState",h="addEventListener",v="onreadystatechange";return!r[g]&&r[h]&&(r[h](p,function y(){r.removeEventListener(p,y,l),r[g]="complete"},l),r[g]="loading"),e.get=o,e.order=function(n,t,o){!function i(r){r=n.shift(),n.length?e(r,i):e(r,t,o)}()},e.path=function(n){i=n},e.ready=function(o,i,r){o=o[m]?o:[o];var c=[];return!t(o,function(n){u[n]||c[m](n)})&&n(o,function(n){return u[n]})?i():!function(n){s[n]=s[n]||[],s[n][m](i),r&&r(c)}(o.join("|")),e},e},this);var _gaq=[["_setAccount","UA-32956520-1"],["_setDomainName",".yeoman.io"],["_trackPageview"],["_trackPageLoadTime"]];$script("http://www.google-analytics.com/ga.js"),$script("https://apis.google.com/js/plusone.js"),$script("//platform.twitter.com/widgets.js");</script></body></html>